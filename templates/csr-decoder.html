{% extends "base.html" %}

{% block title %}CSR Decoder - Free Online Certificate Signing Request Decoder | NetHub Network Tools{% endblock %}

{% block meta_description %}Free CSR decoder tool to decode Certificate Signing Requests. Analyze CSR details, extract information, and validate certificate signing requests online.{% endblock %}

{% block meta_keywords %}CSR decoder, certificate signing request, CSR decode, CSR analysis, CSR validator, CSR decoder online, certificate request decoder{% endblock %}

{% block og_url %}/csr-decoder{% endblock %}

{% block content %}
<div class="container mt-5 pt-4">
    <!-- Header -->
    <div class="text-center mb-5">
        <h1 class="display-4 fw-bold text-primary mb-3">
            <i class="bi bi-file-earmark-text me-3"></i>CSR Decoder
        </h1>
        <p class="lead text-muted">Decode and analyze Certificate Signing Requests (CSR) to extract detailed information about certificate requests</p>
    </div>

    <!-- CSR Decoder Form -->
    <div class="card shadow-lg mb-5">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0"><i class="bi bi-file-earmark-text me-2"></i>CSR Decoder</h5>
        </div>
        <div class="card-body">
            <form @submit.prevent="decodeCSR" class="row g-3">
                <div class="col-12">
                    <label for="csrInput" class="form-label fw-bold">Certificate Signing Request (CSR)</label>
                    <textarea 
                        id="csrInput" 
                        v-model="csrInput" 
                        class="form-control" 
                        rows="8" 
                        placeholder="Paste your CSR here (PEM format)..."
                        required
                    ></textarea>
                    <div class="form-text">Paste your CSR in PEM format (starts with -----BEGIN CERTIFICATE REQUEST-----)</div>
                </div>
                <div class="col-12">
                    <button type="submit" class="btn btn-primary btn-lg" :disabled="isLoading">
                        <span v-if="isLoading" class="spinner-border spinner-border-sm me-2"></span>
                        <i v-else class="bi bi-file-earmark-text me-2"></i>
                        <span v-if="isLoading">Decoding...</span>
                        <span v-else>Decode CSR</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Results -->
    <div v-if="decodedData" class="card shadow-lg">
        <div class="card-header bg-success text-white">
            <h5 class="mb-0"><i class="bi bi-check-circle me-2"></i>CSR Decoded Successfully</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <h6 class="fw-bold text-primary">Subject Information</h6>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex justify-content-between">
                            <span class="fw-bold">Common Name (CN):</span>
                            <span v-text="decodedData.subject.get('CN', 'N/A')"></span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span class="fw-bold">Organization (O):</span>
                            <span v-text="decodedData.subject.get('O', 'N/A')"></span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span class="fw-bold">Organizational Unit (OU):</span>
                            <span v-text="decodedData.subject.get('OU', 'N/A')"></span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span class="fw-bold">Country (C):</span>
                            <span v-text="decodedData.subject.get('C', 'N/A')"></span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span class="fw-bold">State/Province (ST):</span>
                            <span v-text="decodedData.subject.get('ST', 'N/A')"></span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span class="fw-bold">City/Locality (L):</span>
                            <span v-text="decodedData.subject.get('L', 'N/A')"></span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span class="fw-bold">Email (E):</span>
                            <span v-text="decodedData.subject.get('E', 'N/A')"></span>
                        </li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <h6 class="fw-bold text-primary">Technical Details</h6>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex justify-content-between">
                            <span class="fw-bold">Signature Algorithm:</span>
                            <span v-text="decodedData.signature_algorithm"></span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span class="fw-bold">Public Key Algorithm:</span>
                            <span v-text="decodedData.public_key_algorithm"></span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span class="fw-bold">Key Size:</span>
                            <span v-text="decodedData.key_size + ' bits'"></span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span class="fw-bold">Version:</span>
                            <span v-text="decodedData.version"></span>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div v-if="decodedData.san_names && decodedData.san_names.length > 0" class="mt-4">
                <h6 class="fw-bold text-primary">Subject Alternative Names (SAN)</h6>
                <div class="row">
                    <div v-for="san in decodedData.san_names" :key="san" class="col-md-6">
                        <span class="badge bg-info me-2 mb-2" v-text="san"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Error Message -->
    <div v-if="errorMessage" class="alert alert-danger mt-4" role="alert">
        <i class="bi bi-exclamation-triangle me-2"></i>
        <strong>Error:</strong> <span v-text="errorMessage"></span>
    </div>
</div>

<!-- Vue.js App -->
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<script src="/static/csr-decoder-app.js"></script>
{% endblock %}